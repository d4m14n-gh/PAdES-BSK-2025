<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BSK Project Doxygen documentation: C:/Users/macie/OneDrive/Pulpit/informatyka/BSK/PAdES-BSK-2025/SigningPDFsrc/main.py</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">BSK Project Doxygen documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('_c_1_2_users_2macie_2_one_drive_2_pulpit_2informatyka_2_b_s_k_2_p_ad_e_s-_b_s_k-2025_2_signing_p_d_fsrc_2main_8py-example.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">C:/Users/macie/OneDrive/Pulpit/informatyka/BSK/PAdES-BSK-2025/SigningPDFsrc/main.py</div></div>
</div><!--header-->
<div class="contents">
<p>Finds the position of a signature placeholder in a PDF file.</p>
<p>Finds the position of a signature placeholder in a PDF file.This function searches for a specific pattern in a PDF file indicating the start of a signature placeholder. If the placeholder is found, the position of the signature content is returned. Otherwise, it returns <span class="tt">None</span>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pdf_path</td><td>The path to the PDF file to be searched. Must be a valid path to a readable file.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Optional[int]: The position (byte offset) of the signature content if the placeholder is found, or <span class="tt">None</span> if the placeholder is not found.</dd></dl>
<p>@raises FileNotFoundError: If the specified PDF file cannot be found or opened. @raises IOError: If an error occurs while reading the file.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md0"></a>
Example usage of find_signature:</h1>
<p>pdf_path = "example_with_placeholder.pdf"</p>
<p>try: signature_position = find_signature(pdf_path) if signature_position is not None: print(f"Signature placeholder found at byte offset: {signature_position}") else: print("No signature placeholder found in the PDF.") except Exception as e: print(f"An error occurred: {e}")</p>
<div class="fragment"><div class="line"><span class="lineno">    1</span><span class="keyword">import</span> shutil</div>
<div class="line"><span class="lineno">    2</span><span class="keyword">import</span> hashlib</div>
<div class="line"><span class="lineno">    3</span><span class="keyword">import</span> argparse</div>
<div class="line"><span class="lineno">    4</span><span class="keyword">from</span> cryptography.hazmat.primitives <span class="keyword">import</span> serialization</div>
<div class="line"><span class="lineno">    5</span><span class="keyword">from</span> cryptography.hazmat.primitives.asymmetric <span class="keyword">import</span> padding</div>
<div class="line"><span class="lineno">    6</span><span class="keyword">from</span> cryptography.hazmat.primitives <span class="keyword">import</span> hashes</div>
<div class="line"><span class="lineno">    7</span><span class="keyword">from</span> cryptography.hazmat.backends <span class="keyword">import</span> default_backend</div>
<div class="line"><span class="lineno">    8</span><span class="keyword">from</span> typing <span class="keyword">import</span> Optional</div>
<div class="line"><span class="lineno">    9</span> </div>
<div class="line"><span class="lineno">   10</span><span class="keyword">import</span> pypdf</div>
<div class="line"><span class="lineno">   11</span><span class="keyword">from</span> pypdf.generic <span class="keyword">import</span> DictionaryObject, NameObject, ByteStringObject, create_string_object</div>
<div class="line"><span class="lineno">   12</span> </div>
<div class="line"><span class="lineno">   13</span> </div>
<div class="line"><span class="lineno">   14</span><span class="keyword">def </span>create_pdf_placeholder(input_pdf_path: str, output_pdf_path: str, signature_length: int) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   15</span>    <span class="stringliteral">&quot;&quot;&quot;!</span></div>
<div class="line"><span class="lineno">   16</span><span class="stringliteral">    Adds a signature placeholder to a PDF file.</span></div>
<div class="line"><span class="lineno">   17</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   18</span><span class="stringliteral">    This function reads an input PDF file, creates a new PDF with a placeholder </span></div>
<div class="line"><span class="lineno">   19</span><span class="stringliteral">    for a digital signature, and writes the modified content to an output PDF file.</span></div>
<div class="line"><span class="lineno">   20</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   21</span><span class="stringliteral">    @param input_pdf_path: Path to the input PDF file.</span></div>
<div class="line"><span class="lineno">   22</span><span class="stringliteral">                        Must be a valid path to a readable PDF file.</span></div>
<div class="line"><span class="lineno">   23</span><span class="stringliteral">    @param output_pdf_path: Path where the modified PDF file with the signature </span></div>
<div class="line"><span class="lineno">   24</span><span class="stringliteral">                            placeholder will be saved.</span></div>
<div class="line"><span class="lineno">   25</span><span class="stringliteral">    @param signature_length: The length of the signature placeholder in bytes.</span></div>
<div class="line"><span class="lineno">   26</span><span class="stringliteral">                            Determines the size of the placeholder.</span></div>
<div class="line"><span class="lineno">   27</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   28</span><span class="stringliteral">    @returns None</span></div>
<div class="line"><span class="lineno">   29</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   30</span><span class="stringliteral">    @raises FileNotFoundError: If the input PDF file cannot be found or opened.</span></div>
<div class="line"><span class="lineno">   31</span><span class="stringliteral">    @raises IOError: If the output PDF file cannot be written to the specified path.</span></div>
<div class="line"><span class="lineno">   32</span><span class="stringliteral">    @raises Exception: If any error occurs during PDF processing.</span></div>
<div class="line"><span class="lineno">   33</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   34</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   35</span>    <span class="keyword">with</span> open(input_pdf_path, <span class="stringliteral">&#39;rb&#39;</span>) <span class="keyword">as</span> input_file, open(output_pdf_path, <span class="stringliteral">&#39;wb&#39;</span>) <span class="keyword">as</span> output_file:</div>
<div class="line"><span class="lineno">   36</span>        reader = pypdf.PdfReader(input_file)</div>
<div class="line"><span class="lineno">   37</span>        writer = pypdf.PdfWriter()</div>
<div class="line"><span class="lineno">   38</span> </div>
<div class="line"><span class="lineno">   39</span>        <span class="keywordflow">for</span> page <span class="keywordflow">in</span> reader.pages:</div>
<div class="line"><span class="lineno">   40</span>            writer.add_page(page)</div>
<div class="line"><span class="lineno">   41</span> </div>
<div class="line"><span class="lineno">   42</span>        <span class="comment"># Tworzymy obiekt podpisu /Sig — BEZ formularzy, bez Annots</span></div>
<div class="line"><span class="lineno">   43</span>        sig_dict = DictionaryObject()</div>
<div class="line"><span class="lineno">   44</span>        sig_dict.update({</div>
<div class="line"><span class="lineno">   45</span>            NameObject(<span class="stringliteral">&quot;/Type&quot;</span>): NameObject(<span class="stringliteral">&quot;/BskSignature&quot;</span>),</div>
<div class="line"><span class="lineno">   46</span>            NameObject(<span class="stringliteral">&quot;/Contents&quot;</span>): create_string_object(<span class="stringliteral">&quot;0&quot;</span>*signature_length), <span class="comment">#ByteStringObject( random.randbytes(signature_length // 8) ), # rsa 4096</span></div>
<div class="line"><span class="lineno">   47</span>        })</div>
<div class="line"><span class="lineno">   48</span>        writer._add_object(sig_dict)</div>
<div class="line"><span class="lineno">   49</span>        <span class="keyword">with</span> open(output_pdf_path, <span class="stringliteral">&quot;wb&quot;</span>) <span class="keyword">as</span> f_out:</div>
<div class="line"><span class="lineno">   50</span>            writer.write(f_out)</div>
<div class="line"><span class="lineno">   51</span> </div>
<div class="line"><span class="lineno">   52</span><span class="keyword">def </span>replace_bytes_at_offset(file_path: str, offset: int, new_bytes: bytes, output_path: str = <span class="keywordtype">None</span>) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   53</span>    <span class="stringliteral">&quot;&quot;&quot;!</span></div>
<div class="line"><span class="lineno">   54</span><span class="stringliteral">    Replaces a sequence of bytes at a specified offset in a binary file.</span></div>
<div class="line"><span class="lineno">   55</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   56</span><span class="stringliteral">    This function modifies a binary file by replacing a sequence of bytes at a given offset </span></div>
<div class="line"><span class="lineno">   57</span><span class="stringliteral">    with a new sequence of bytes. The modified content can be saved to a new file or </span></div>
<div class="line"><span class="lineno">   58</span><span class="stringliteral">    overwrite the original file.</span></div>
<div class="line"><span class="lineno">   59</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   60</span><span class="stringliteral">    @param file_path: Path to the input binary file. Must be a valid and readable file path.</span></div>
<div class="line"><span class="lineno">   61</span><span class="stringliteral">    @param offset: The position (in bytes) where the replacement should begin. Must be within </span></div>
<div class="line"><span class="lineno">   62</span><span class="stringliteral">                the file&#39;s length and not exceed the file&#39;s boundaries.</span></div>
<div class="line"><span class="lineno">   63</span><span class="stringliteral">    @param new_bytes: The new sequence of bytes to replace at the specified offset.</span></div>
<div class="line"><span class="lineno">   64</span><span class="stringliteral">                    Must be a `bytes` object.</span></div>
<div class="line"><span class="lineno">   65</span><span class="stringliteral">    @param output_path: Path to save the modified file. If `None`, the original file is overwritten.</span></div>
<div class="line"><span class="lineno">   66</span><span class="stringliteral">                    (Default is None.)</span></div>
<div class="line"><span class="lineno">   67</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   68</span><span class="stringliteral">    @returns None</span></div>
<div class="line"><span class="lineno">   69</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   70</span><span class="stringliteral">    @raises ValueError: If the offset is invalid (negative, too large, or causes an overflow).</span></div>
<div class="line"><span class="lineno">   71</span><span class="stringliteral">    @raises FileNotFoundError: If the input file cannot be found or opened.</span></div>
<div class="line"><span class="lineno">   72</span><span class="stringliteral">    @raises IOError: If the output file cannot be written to the specified path.</span></div>
<div class="line"><span class="lineno">   73</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   74</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   75</span>    <span class="keyword">with</span> open(file_path, <span class="stringliteral">&#39;rb&#39;</span>) <span class="keyword">as</span> f:</div>
<div class="line"><span class="lineno">   76</span>        content = bytearray(f.read())</div>
<div class="line"><span class="lineno">   77</span>    <span class="keywordflow">if</span> offset &lt; 0 <span class="keywordflow">or</span> offset + len(new_bytes) &gt; len(content):</div>
<div class="line"><span class="lineno">   78</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Wrong offset.&quot;</span>)</div>
<div class="line"><span class="lineno">   79</span>    content[offset:offset + len(new_bytes)] = new_bytes</div>
<div class="line"><span class="lineno">   80</span>    <span class="keywordflow">if</span> output_path <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   81</span>        output_path = file_path</div>
<div class="line"><span class="lineno">   82</span>    <span class="keyword">with</span> open(output_path, <span class="stringliteral">&#39;wb&#39;</span>) <span class="keyword">as</span> f:</div>
<div class="line"><span class="lineno">   83</span>        f.write(content)</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span><span class="keyword">def </span>find_signature(pdf_path: str) -&gt; Optional[int]:</div>
<div class="line"><span class="lineno">   86</span>    <span class="stringliteral">&quot;&quot;&quot;!</span></div>
<div class="line"><span class="lineno">   87</span><span class="stringliteral">    Finds the position of a signature placeholder in a PDF file.</span></div>
<div class="line"><span class="lineno">   88</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   89</span><span class="stringliteral">    This function searches for a specific pattern in a PDF file indicating the start of </span></div>
<div class="line"><span class="lineno">   90</span><span class="stringliteral">    a signature placeholder. If the placeholder is found, the position of the signature </span></div>
<div class="line"><span class="lineno">   91</span><span class="stringliteral">    content is returned. Otherwise, it returns `None`.</span></div>
<div class="line"><span class="lineno">   92</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   93</span><span class="stringliteral">    @param pdf_path: The path to the PDF file to be searched. Must be a valid path to a readable file.</span></div>
<div class="line"><span class="lineno">   94</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   95</span><span class="stringliteral">    @returns Optional[int]: The position (byte offset) of the signature content if the placeholder is found, </span></div>
<div class="line"><span class="lineno">   96</span><span class="stringliteral">                            or `None` if the placeholder is not found.</span></div>
<div class="line"><span class="lineno">   97</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   98</span><span class="stringliteral">    @raises FileNotFoundError: If the specified PDF file cannot be found or opened.</span></div>
<div class="line"><span class="lineno">   99</span><span class="stringliteral">    @raises IOError: If an error occurs while reading the file.</span></div>
<div class="line"><span class="lineno">  100</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  101</span><span class="stringliteral">    @example</span></div>
<div class="line"><span class="lineno">  102</span><span class="stringliteral">    # Example usage of find_signature:</span></div>
<div class="line"><span class="lineno">  103</span><span class="stringliteral">    pdf_path = &quot;example_with_placeholder.pdf&quot;</span></div>
<div class="line"><span class="lineno">  104</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  105</span><span class="stringliteral">    try:</span></div>
<div class="line"><span class="lineno">  106</span><span class="stringliteral">        signature_position = find_signature(pdf_path)</span></div>
<div class="line"><span class="lineno">  107</span><span class="stringliteral">        if signature_position is not None:</span></div>
<div class="line"><span class="lineno">  108</span><span class="stringliteral">            print(f&quot;Signature placeholder found at byte offset: {signature_position}&quot;)</span></div>
<div class="line"><span class="lineno">  109</span><span class="stringliteral">        else:</span></div>
<div class="line"><span class="lineno">  110</span><span class="stringliteral">            print(&quot;No signature placeholder found in the PDF.&quot;)</span></div>
<div class="line"><span class="lineno">  111</span><span class="stringliteral">    except Exception as e:</span></div>
<div class="line"><span class="lineno">  112</span><span class="stringliteral">        print(f&quot;An error occurred: {e}&quot;)</span></div>
<div class="line"><span class="lineno">  113</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  114</span>    <span class="keyword">with</span> open(pdf_path, <span class="stringliteral">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</div>
<div class="line"><span class="lineno">  115</span>        pattern = b<span class="stringliteral">&quot;/Type /BskSignature\n/Contents (&quot;</span></div>
<div class="line"><span class="lineno">  116</span>        position = f.read().find(pattern)</div>
<div class="line"><span class="lineno">  117</span>        </div>
<div class="line"><span class="lineno">  118</span>        <span class="keywordflow">if</span> position != -1:</div>
<div class="line"><span class="lineno">  119</span>            position+=len(pattern)</div>
<div class="line"><span class="lineno">  120</span>            print(f<span class="stringliteral">&quot;Placeholder: {position}&quot;</span>)</div>
<div class="line"><span class="lineno">  121</span>            <span class="keywordflow">return</span> position</div>
<div class="line"><span class="lineno">  122</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  123</span>            print(<span class="stringliteral">&quot;Placeholder not found.&quot;</span>)</div>
<div class="line"><span class="lineno">  124</span>    <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span><span class="keyword">def </span>get_signature(pdf_path: str, position: int, signature_length: int) -&gt; str:</div>
<div class="line"><span class="lineno">  127</span>    <span class="stringliteral">&quot;&quot;&quot;!</span></div>
<div class="line"><span class="lineno">  128</span><span class="stringliteral">    Extracts the signature data from a PDF file at a specified position.</span></div>
<div class="line"><span class="lineno">  129</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  130</span><span class="stringliteral">    This function reads a specified number of bytes starting from a given position </span></div>
<div class="line"><span class="lineno">  131</span><span class="stringliteral">    in a PDF file and decodes it into a string representing the signature data.</span></div>
<div class="line"><span class="lineno">  132</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  133</span><span class="stringliteral">    @param pdf_path: The path to the PDF file. Must be a valid path to a readable PDF file.</span></div>
<div class="line"><span class="lineno">  134</span><span class="stringliteral">    @param position: The byte offset where the signature data begins. Must be a valid position within the file.</span></div>
<div class="line"><span class="lineno">  135</span><span class="stringliteral">    @param signature_length: The number of bytes to read for the signature data.</span></div>
<div class="line"><span class="lineno">  136</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  137</span><span class="stringliteral">    @returns str: The decoded signature data as a string.</span></div>
<div class="line"><span class="lineno">  138</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  139</span><span class="stringliteral">    @raises FileNotFoundError: If the specified PDF file cannot be found or opened.</span></div>
<div class="line"><span class="lineno">  140</span><span class="stringliteral">    @raises ValueError: If the position or signature length is invalid.</span></div>
<div class="line"><span class="lineno">  141</span><span class="stringliteral">    @raises UnicodeDecodeError: If the read bytes cannot be decoded into a string.</span></div>
<div class="line"><span class="lineno">  142</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  143</span><span class="stringliteral">    @example</span></div>
<div class="line"><span class="lineno">  144</span><span class="stringliteral">    # Example usage of get_signature:</span></div>
<div class="line"><span class="lineno">  145</span><span class="stringliteral">    pdf_path = &quot;example_with_placeholder.pdf&quot;</span></div>
<div class="line"><span class="lineno">  146</span><span class="stringliteral">    position = 1500  # Position of the signature in the file</span></div>
<div class="line"><span class="lineno">  147</span><span class="stringliteral">    signature_length = 256  # Length of the signature in bytes</span></div>
<div class="line"><span class="lineno">  148</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  149</span><span class="stringliteral">    try:</span></div>
<div class="line"><span class="lineno">  150</span><span class="stringliteral">        signature = get_signature(pdf_path, position, signature_length)</span></div>
<div class="line"><span class="lineno">  151</span><span class="stringliteral">        print(f&quot;Extracted signature: {signature}&quot;)</span></div>
<div class="line"><span class="lineno">  152</span><span class="stringliteral">    except Exception as e:</span></div>
<div class="line"><span class="lineno">  153</span><span class="stringliteral">        print(f&quot;An error occurred: {e}&quot;)</span></div>
<div class="line"><span class="lineno">  154</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  155</span>    <span class="keyword">with</span> open(pdf_path, <span class="stringliteral">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</div>
<div class="line"><span class="lineno">  156</span>        f.seek(position)</div>
<div class="line"><span class="lineno">  157</span>        signature_data = f.read(signature_length)</div>
<div class="line"><span class="lineno">  158</span>        <span class="keywordflow">return</span> signature_data.decode()</div>
<div class="line"><span class="lineno">  159</span>          </div>
<div class="line"><span class="lineno">  160</span> </div>
<div class="line"><span class="lineno">  161</span><span class="keyword">def </span>calculate_sha256(file_path: str, start_position: int, length_of_section: int) -&gt; str:</div>
<div class="line"><span class="lineno">  162</span>    <span class="stringliteral">&quot;&quot;&quot;!</span></div>
<div class="line"><span class="lineno">  163</span><span class="stringliteral">    Calculates the SHA-256 hash of a file excluding a specific section.</span></div>
<div class="line"><span class="lineno">  164</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  165</span><span class="stringliteral">    This function computes the SHA-256 hash of a file, omitting a specified section </span></div>
<div class="line"><span class="lineno">  166</span><span class="stringliteral">    defined by its starting position and length. It reads the file in two parts: </span></div>
<div class="line"><span class="lineno">  167</span><span class="stringliteral">    before and after the excluded section, and concatenates the remaining data to </span></div>
<div class="line"><span class="lineno">  168</span><span class="stringliteral">    calculate the hash.</span></div>
<div class="line"><span class="lineno">  169</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  170</span><span class="stringliteral">    @param file_path: The path to the file to hash. Must be a valid path to a readable file.</span></div>
<div class="line"><span class="lineno">  171</span><span class="stringliteral">    @param start_position: The byte offset where the excluded section begins. Must be within the file&#39;s length.</span></div>
<div class="line"><span class="lineno">  172</span><span class="stringliteral">    @param length_of_section: The number of bytes to exclude from the hash computation.</span></div>
<div class="line"><span class="lineno">  173</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  174</span><span class="stringliteral">    @returns str: The computed SHA-256 hash as a hexadecimal string.</span></div>
<div class="line"><span class="lineno">  175</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  176</span><span class="stringliteral">    @raises FileNotFoundError: If the specified file cannot be found or opened.</span></div>
<div class="line"><span class="lineno">  177</span><span class="stringliteral">    @raises ValueError: If the start position or section length is invalid.</span></div>
<div class="line"><span class="lineno">  178</span><span class="stringliteral">    @raises IOError: If an error occurs while reading the file.</span></div>
<div class="line"><span class="lineno">  179</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  180</span><span class="stringliteral">    @example</span></div>
<div class="line"><span class="lineno">  181</span><span class="stringliteral">    # Example usage of calculate_sha256:</span></div>
<div class="line"><span class="lineno">  182</span><span class="stringliteral">    file_path = &quot;example_file.bin&quot;</span></div>
<div class="line"><span class="lineno">  183</span><span class="stringliteral">    start_position = 100</span></div>
<div class="line"><span class="lineno">  184</span><span class="stringliteral">    length_of_section = 50</span></div>
<div class="line"><span class="lineno">  185</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  186</span><span class="stringliteral">    try:</span></div>
<div class="line"><span class="lineno">  187</span><span class="stringliteral">        hash_value = calculate_sha256(file_path, start_position, length_of_section)</span></div>
<div class="line"><span class="lineno">  188</span><span class="stringliteral">        print(f&quot;SHA-256 hash excluding section: {hash_value}&quot;)</span></div>
<div class="line"><span class="lineno">  189</span><span class="stringliteral">    except Exception as e:</span></div>
<div class="line"><span class="lineno">  190</span><span class="stringliteral">        print(f&quot;An error occurred: {e}&quot;)</span></div>
<div class="line"><span class="lineno">  191</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  192</span>    <span class="keyword">with</span> open(file_path, <span class="stringliteral">&quot;rb&quot;</span>) <span class="keyword">as</span> file:</div>
<div class="line"><span class="lineno">  193</span>        file.seek(0)</div>
<div class="line"><span class="lineno">  194</span>        data_before = file.read(start_position)</div>
<div class="line"><span class="lineno">  195</span>        file.seek(start_position + length_of_section)</div>
<div class="line"><span class="lineno">  196</span>        data_after = file.read()</div>
<div class="line"><span class="lineno">  197</span>        remaining_data = data_before + data_after</div>
<div class="line"><span class="lineno">  198</span>        sha256_hash = hashlib.sha256()</div>
<div class="line"><span class="lineno">  199</span>        sha256_hash.update(remaining_data)</div>
<div class="line"><span class="lineno">  200</span>        <span class="keywordflow">return</span> sha256_hash.hexdigest()</div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span><span class="keyword">def </span>sign_hash_with_private_key(hash_value: str, private_key_path: str) -&gt; str:</div>
<div class="line"><span class="lineno">  203</span>    <span class="stringliteral">&quot;&quot;&quot;!</span></div>
<div class="line"><span class="lineno">  204</span><span class="stringliteral">    Signs a hash value using a private key.</span></div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  206</span><span class="stringliteral">    This function takes a hash value and a private key, and generates a signature for the hash </span></div>
<div class="line"><span class="lineno">  207</span><span class="stringliteral">    using the RSA private key. The signature is returned as a hexadecimal string.</span></div>
<div class="line"><span class="lineno">  208</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  209</span><span class="stringliteral">    @param hash_value: The hash value to sign, represented as a hexadecimal string.</span></div>
<div class="line"><span class="lineno">  210</span><span class="stringliteral">    @param private_key_path: Path to the private key file in PEM format. </span></div>
<div class="line"><span class="lineno">  211</span><span class="stringliteral">                            The file must be accessible and contain a valid RSA private key.</span></div>
<div class="line"><span class="lineno">  212</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  213</span><span class="stringliteral">    @returns str: The generated signature as a hexadecimal string.</span></div>
<div class="line"><span class="lineno">  214</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  215</span><span class="stringliteral">    @raises FileNotFoundError: If the private key file cannot be found or opened.</span></div>
<div class="line"><span class="lineno">  216</span><span class="stringliteral">    @raises ValueError: If the hash value is invalid or the private key is not in the correct format.</span></div>
<div class="line"><span class="lineno">  217</span><span class="stringliteral">    @raises Exception: If signing the hash fails due to any other reason.</span></div>
<div class="line"><span class="lineno">  218</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  219</span><span class="stringliteral">    @example</span></div>
<div class="line"><span class="lineno">  220</span><span class="stringliteral">    # Example usage of sign_hash_with_private_key:</span></div>
<div class="line"><span class="lineno">  221</span><span class="stringliteral">    hash_value = &quot;9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08&quot;</span></div>
<div class="line"><span class="lineno">  222</span><span class="stringliteral">    private_key_path = &quot;private_key.pem&quot;</span></div>
<div class="line"><span class="lineno">  223</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  224</span><span class="stringliteral">    try:</span></div>
<div class="line"><span class="lineno">  225</span><span class="stringliteral">        signature = sign_hash_with_private_key(hash_value, private_key_path)</span></div>
<div class="line"><span class="lineno">  226</span><span class="stringliteral">        print(f&quot;Generated signature: {signature}&quot;)</span></div>
<div class="line"><span class="lineno">  227</span><span class="stringliteral">    except Exception as e:</span></div>
<div class="line"><span class="lineno">  228</span><span class="stringliteral">        print(f&quot;An error occurred: {e}&quot;)</span></div>
<div class="line"><span class="lineno">  229</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  230</span>    <span class="keyword">with</span> open(private_key_path, <span class="stringliteral">&#39;rb&#39;</span>) <span class="keyword">as</span> key_file:</div>
<div class="line"><span class="lineno">  231</span>        private_key = serialization.load_pem_private_key(</div>
<div class="line"><span class="lineno">  232</span>            key_file.read(),</div>
<div class="line"><span class="lineno">  233</span>            password=<span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  234</span>            backend=default_backend()</div>
<div class="line"><span class="lineno">  235</span>        )</div>
<div class="line"><span class="lineno">  236</span>    signature = private_key.sign(</div>
<div class="line"><span class="lineno">  237</span>        bytes.fromhex(hash_value),</div>
<div class="line"><span class="lineno">  238</span>        padding.PKCS1v15(),</div>
<div class="line"><span class="lineno">  239</span>        hashes.SHA256() </div>
<div class="line"><span class="lineno">  240</span>    )</div>
<div class="line"><span class="lineno">  241</span>   </div>
<div class="line"><span class="lineno">  242</span>    <span class="keywordflow">return</span> signature.hex()</div>
<div class="line"><span class="lineno">  243</span> </div>
<div class="line"><span class="lineno">  244</span> </div>
<div class="line"><span class="lineno">  245</span><span class="keyword">def </span>verify_signature_with_public_key(hash_value: str, signature: str, public_key_path: str) -&gt; bool: </div>
<div class="line"><span class="lineno">  246</span>    <span class="stringliteral">&quot;&quot;&quot;!</span></div>
<div class="line"><span class="lineno">  247</span><span class="stringliteral">    Verifies a signature using a public key.</span></div>
<div class="line"><span class="lineno">  248</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  249</span><span class="stringliteral">    This function takes a hash value, a signature, and a public key to verify the authenticity </span></div>
<div class="line"><span class="lineno">  250</span><span class="stringliteral">    of the signature. It returns `True` if the signature is valid, otherwise returns `False`.</span></div>
<div class="line"><span class="lineno">  251</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  252</span><span class="stringliteral">    @param hash_value: The original hash value, represented as a hexadecimal string.</span></div>
<div class="line"><span class="lineno">  253</span><span class="stringliteral">    @param signature: The signature to verify, represented as a hexadecimal string.</span></div>
<div class="line"><span class="lineno">  254</span><span class="stringliteral">    @param public_key_path: Path to the public key file in PEM format. The file must be </span></div>
<div class="line"><span class="lineno">  255</span><span class="stringliteral">                            accessible and contain a valid RSA public key.</span></div>
<div class="line"><span class="lineno">  256</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  257</span><span class="stringliteral">    @returns bool: `True` if the signature is valid, `False` otherwise.</span></div>
<div class="line"><span class="lineno">  258</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  259</span><span class="stringliteral">    @raises FileNotFoundError: If the public key file cannot be found or opened.</span></div>
<div class="line"><span class="lineno">  260</span><span class="stringliteral">    @raises ValueError: If the hash value or signature is invalid, or the public key is not </span></div>
<div class="line"><span class="lineno">  261</span><span class="stringliteral">                        in the correct format.</span></div>
<div class="line"><span class="lineno">  262</span><span class="stringliteral">    @raises Exception: If verification fails for any other reason.</span></div>
<div class="line"><span class="lineno">  263</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  264</span><span class="stringliteral">    @example</span></div>
<div class="line"><span class="lineno">  265</span><span class="stringliteral">    # Example usage of verify_signature_with_public_key:</span></div>
<div class="line"><span class="lineno">  266</span><span class="stringliteral">    hash_value = &quot;9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08&quot;</span></div>
<div class="line"><span class="lineno">  267</span><span class="stringliteral">    signature = &quot;b3f2a1e6f1a2c94f88e45d067e76c58abefbeee44c8a8453c817bd7a4b8b0a6e&quot;</span></div>
<div class="line"><span class="lineno">  268</span><span class="stringliteral">    public_key_path = &quot;public_key.pem&quot;</span></div>
<div class="line"><span class="lineno">  269</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  270</span><span class="stringliteral">    try:</span></div>
<div class="line"><span class="lineno">  271</span><span class="stringliteral">        is_valid = verify_signature_with_public_key(hash_value, signature, public_key_path)</span></div>
<div class="line"><span class="lineno">  272</span><span class="stringliteral">        if is_valid:</span></div>
<div class="line"><span class="lineno">  273</span><span class="stringliteral">            print(&quot;Signature is valid.&quot;)</span></div>
<div class="line"><span class="lineno">  274</span><span class="stringliteral">        else:</span></div>
<div class="line"><span class="lineno">  275</span><span class="stringliteral">            print(&quot;Signature is invalid.&quot;)</span></div>
<div class="line"><span class="lineno">  276</span><span class="stringliteral">    except Exception as e:</span></div>
<div class="line"><span class="lineno">  277</span><span class="stringliteral">        print(f&quot;An error occurred: {e}&quot;)</span></div>
<div class="line"><span class="lineno">  278</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  279</span>    <span class="keyword">with</span> open(public_key_path, <span class="stringliteral">&#39;rb&#39;</span>) <span class="keyword">as</span> key_file:</div>
<div class="line"><span class="lineno">  280</span>        public_key = serialization.load_pem_public_key(</div>
<div class="line"><span class="lineno">  281</span>            key_file.read(),</div>
<div class="line"><span class="lineno">  282</span>            backend=default_backend()</div>
<div class="line"><span class="lineno">  283</span>        )</div>
<div class="line"><span class="lineno">  284</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  285</span>        public_key.verify(</div>
<div class="line"><span class="lineno">  286</span>            bytes.fromhex(signature),</div>
<div class="line"><span class="lineno">  287</span>            bytes.fromhex(hash_value),</div>
<div class="line"><span class="lineno">  288</span>            padding.PKCS1v15(),</div>
<div class="line"><span class="lineno">  289</span>            hashes.SHA256()</div>
<div class="line"><span class="lineno">  290</span>        )</div>
<div class="line"><span class="lineno">  291</span>        <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  292</span>    <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  293</span>        print(f<span class="stringliteral">&quot;Verification failed: {e}&quot;</span>)</div>
<div class="line"><span class="lineno">  294</span>        <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  295</span>    </div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span> </div>
<div class="line"><span class="lineno">  299</span>SIGNATURE_LENGTH = 4096</div>
<div class="line"><span class="lineno">  300</span>SIGNATURE_LENGTH_BYTES = SIGNATURE_LENGTH // 8</div>
<div class="line"><span class="lineno">  301</span>SIGNATURE_LENGTH_HEX = SIGNATURE_LENGTH_BYTES * 2</div>
<div class="line"><span class="lineno">  302</span> </div>
<div class="line"><span class="lineno">  303</span><span class="keyword">def </span>sign_pdf_using_private_key(input_pdf_path: str, output_pdf_path: str, private_key_path: str) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  304</span>    <span class="stringliteral">&quot;&quot;&quot;!</span></div>
<div class="line"><span class="lineno">  305</span><span class="stringliteral">    Signs a PDF file by inserting a digital signature using a private key.</span></div>
<div class="line"><span class="lineno">  306</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  307</span><span class="stringliteral">    This function copies the input PDF to the output path, checks if a signature placeholder </span></div>
<div class="line"><span class="lineno">  308</span><span class="stringliteral">    exists, and if not, creates one. It then calculates the SHA-256 hash of the PDF excluding </span></div>
<div class="line"><span class="lineno">  309</span><span class="stringliteral">    the placeholder section, signs this hash with the specified private key, and replaces </span></div>
<div class="line"><span class="lineno">  310</span><span class="stringliteral">    the placeholder in the output PDF with the generated signature.</span></div>
<div class="line"><span class="lineno">  311</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  312</span><span class="stringliteral">    @param input_pdf_path: Path to the original PDF file to be signed.</span></div>
<div class="line"><span class="lineno">  313</span><span class="stringliteral">    @param output_pdf_path: Path where the signed PDF will be saved.</span></div>
<div class="line"><span class="lineno">  314</span><span class="stringliteral">    @param private_key_path: Path to the private key file (PEM format) used for signing.</span></div>
<div class="line"><span class="lineno">  315</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  316</span><span class="stringliteral">    @returns None</span></div>
<div class="line"><span class="lineno">  317</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  318</span><span class="stringliteral">    @raises FileNotFoundError: If any of the input files (PDF or private key) cannot be found.</span></div>
<div class="line"><span class="lineno">  319</span><span class="stringliteral">    @raises ValueError: If signature placeholder is not found or signature length is invalid.</span></div>
<div class="line"><span class="lineno">  320</span><span class="stringliteral">    @raises Exception: For other errors such as issues with hashing, signing, or file I/O.</span></div>
<div class="line"><span class="lineno">  321</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  322</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  323</span>    shutil.copy(input_pdf_path, output_pdf_path)   </div>
<div class="line"><span class="lineno">  324</span>    if(find_signature(output_pdf_path) <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  325</span>        print(<span class="stringliteral">&quot;Signature already exists.&quot;</span>)</div>
<div class="line"><span class="lineno">  326</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  327</span>        create_pdf_placeholder(input_pdf_path, output_pdf_path, SIGNATURE_LENGTH_HEX)</div>
<div class="line"><span class="lineno">  328</span>    signature_positon = find_signature(output_pdf_path)</div>
<div class="line"><span class="lineno">  329</span> </div>
<div class="line"><span class="lineno">  330</span>    hash = calculate_sha256(output_pdf_path, signature_positon, SIGNATURE_LENGTH_HEX)</div>
<div class="line"><span class="lineno">  331</span>    print(f<span class="stringliteral">&quot;Hash value({len(hash)}): {hash}&quot;</span>)</div>
<div class="line"><span class="lineno">  332</span>    signature = sign_hash_with_private_key(hash, private_key_path)</div>
<div class="line"><span class="lineno">  333</span>    print(f<span class="stringliteral">&quot;Signature({len(signature)}): {signature}&quot;</span>)</div>
<div class="line"><span class="lineno">  334</span> </div>
<div class="line"><span class="lineno">  335</span>    replace_bytes_at_offset(output_pdf_path, signature_positon, signature.encode(), output_pdf_path)</div>
<div class="line"><span class="lineno">  336</span>    print(f<span class="stringliteral">&quot;Signed PDF: {input_pdf_path} to: {output_pdf_path}&quot;</span>)</div>
<div class="line"><span class="lineno">  337</span> </div>
<div class="line"><span class="lineno">  338</span><span class="keyword">def </span>verify_signed_pdf(input_pdf_path: str, public_key_path: str) -&gt; bool:</div>
<div class="line"><span class="lineno">  339</span>    <span class="stringliteral">&quot;&quot;&quot;!</span></div>
<div class="line"><span class="lineno">  340</span><span class="stringliteral">    @brief Verifies the digital signature of a signed PDF file using a public key.</span></div>
<div class="line"><span class="lineno">  341</span><span class="stringliteral">    This function locates the signature placeholder in the PDF, extracts the signature,</span></div>
<div class="line"><span class="lineno">  342</span><span class="stringliteral">    calculates the SHA-256 hash of the PDF excluding the signature section, and verifies</span></div>
<div class="line"><span class="lineno">  343</span><span class="stringliteral">    the signature against the hash using the provided public key.</span></div>
<div class="line"><span class="lineno">  344</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  345</span><span class="stringliteral">    @param input_pdf_path: Path to the signed PDF file to verify.</span></div>
<div class="line"><span class="lineno">  346</span><span class="stringliteral">    @param public_key_path: Path to the public key file (PEM format) used for verification.</span></div>
<div class="line"><span class="lineno">  347</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  348</span><span class="stringliteral">    @returns bool: Returns True if the signature is valid, False otherwise.</span></div>
<div class="line"><span class="lineno">  349</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  350</span><span class="stringliteral">    @raises FileNotFoundError: If the PDF file or public key file cannot be found.</span></div>
<div class="line"><span class="lineno">  351</span><span class="stringliteral">    @raises ValueError: If the signature placeholder is missing or signature length is invalid.</span></div>
<div class="line"><span class="lineno">  352</span><span class="stringliteral">    @raises Exception: For errors occurring during hashing, signature extraction, or verification.</span></div>
<div class="line"><span class="lineno">  353</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  354</span>    hash = calculate_sha256(input_pdf_path, signature_positon, SIGNATURE_LENGTH_HEX)</div>
<div class="line"><span class="lineno">  355</span>    signature = get_signature(input_pdf_path, signature_positon, SIGNATURE_LENGTH_HEX)</div>
<div class="line"><span class="lineno">  356</span>    print(f<span class="stringliteral">&quot;Hash value({len(hash)}): {hash}&quot;</span>)</div>
<div class="line"><span class="lineno">  357</span>    print(f<span class="stringliteral">&quot;Signature({len(signature)}): {signature}&quot;</span>)</div>
<div class="line"><span class="lineno">  358</span> </div>
<div class="line"><span class="lineno">  359</span>    verified = verify_signature_with_public_key(hash, signature, public_key_path)</div>
<div class="line"><span class="lineno">  360</span>    print(f<span class="stringliteral">&quot;Signature verified: {input_pdf_path} with: {public_key_path}&quot;</span>)</div>
<div class="line"><span class="lineno">  361</span>    <span class="keywordflow">return</span> verified</div>
<div class="line"><span class="lineno">  362</span> </div>
<div class="line"><span class="lineno">  363</span> </div>
<div class="line"><span class="lineno">  364</span><span class="keyword">def </span><a class="code hl_namespace" href="namespacemain.html">main</a>():</div>
<div class="line"><span class="lineno">  365</span>    parser = argparse.ArgumentParser(description=<span class="stringliteral">&quot;Aplikacja do podpisywania i weryfikacji plików PDF&quot;</span>)</div>
<div class="line"><span class="lineno">  366</span>    parser.add_argument(<span class="stringliteral">&#39;--verify&#39;</span>, help=<span class="stringliteral">&quot;Weryfikacja podpisu&quot;</span>, nargs=2, metavar=(<span class="stringliteral">&#39;input&#39;</span>, <span class="stringliteral">&#39;public_key&#39;</span>))</div>
<div class="line"><span class="lineno">  367</span>    parser.add_argument(<span class="stringliteral">&#39;--sign&#39;</span>, help=<span class="stringliteral">&quot;Podpisywanie pliku&quot;</span>, nargs=3, metavar=(<span class="stringliteral">&#39;input&#39;</span>, <span class="stringliteral">&#39;output&#39;</span>, <span class="stringliteral">&#39;private_key&#39;</span>))</div>
<div class="line"><span class="lineno">  368</span>    args = parser.parse_args()</div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>    <span class="keywordflow">if</span> args.verify:</div>
<div class="line"><span class="lineno">  371</span>        input_path, public_key_path = args.verify</div>
<div class="line"><span class="lineno">  372</span>        v = verify_signed_pdf(input_path, public_key_path)</div>
<div class="line"><span class="lineno">  373</span>        print(f<span class="stringliteral">&quot;Weryfikacja podpisu zakończona. Plik: {input_path}, Klucz publiczny: {public_key_path}. Wynik: {v}&quot;</span>)</div>
<div class="line"><span class="lineno">  374</span> </div>
<div class="line"><span class="lineno">  375</span>    <span class="keywordflow">elif</span> args.sign:</div>
<div class="line"><span class="lineno">  376</span>        input_path, output_path, private_key_path = args.sign</div>
<div class="line"><span class="lineno">  377</span>        sign_pdf_using_private_key(input_path, output_path, private_key_path)</div>
<div class="line"><span class="lineno">  378</span>        print(f<span class="stringliteral">&quot;Podpisano plik PDF: {input_path} i zapisano jako: {output_path}&quot;</span>)</div>
<div class="line"><span class="lineno">  379</span> </div>
<div class="line"><span class="lineno">  380</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  381</span>        print(<span class="stringliteral">&quot;Brak wymaganych argumentów. Użyj --help, aby zobaczyć dostępne opcje.&quot;</span>)</div>
<div class="line"><span class="lineno">  382</span> </div>
<div class="line"><span class="lineno">  383</span><span class="keywordflow">if</span> __name__ == <span class="stringliteral">&#39;__main__&#39;</span>:</div>
<div class="line"><span class="lineno">  384</span>    <a class="code hl_namespace" href="namespacemain.html">main</a>()</div>
<div class="ttc" id="anamespacemain_html"><div class="ttname"><a href="namespacemain.html">main</a></div><div class="ttdef"><b>Definition</b> main.py:1</div></div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
